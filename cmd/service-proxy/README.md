# Running `service-proxy` service locally

You can run the `service-proxy` service locally to debug and test against a running greenhouse cluster.

## Prerequisites

Point the environment variable `KUBECONFIG` to the kubeconfig file of the target greenhouse cluster you want to test against.

The exposed service URLs generated on the target Greenhouse cluster need to be reachable from your local machine.
Set the environment variable `GREENHOUSE_DNS_DOMAIN` to the DNS domain used in the target greenhouse cluster. For example: `myorg.greenhouse.tld`

In order to forward the requests to your local machine, you can use a service like `nip.io` that maps wildcard DNS to IP addresses.
Set the environment variable `DEBUG_DOMAIN` to a domain that maps to your local machine. For example: `127.0.0.1.nip.io:8080`

This will override the DNS domain in the exposed service URLs generated on the target greenhouse cluster, allowing you to access them locally.

## Running the service

Run the service proxy locally passing the arguments for `--kubecontext` and `--kubenamespace` to point to the correct organization in the target greenhouse cluster.

In your browser you can now access the exposed services using the URLs generated by the service proxy, which will be redirected to your local machine. For this take the generated part `<cluster-name>--<service-hash>` and prepend it to the `DEBUG_DOMAIN`.

e.g. `http://testcluster--abcdefg.127.0.0.1.nip.io:8080/`
