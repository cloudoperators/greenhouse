{{/* 
SPDX-FileCopyrightText: 2024 SAP SE or an SAP affiliate company and Greenhouse contributors
SPDX-License-Identifier: Apache-2.0
*/}}

{{- $secret := (lookup "v1" "Secret" "demo" "demo-token" ) | default dict -}}
{{- $secretData := (get $secret "data") | default dict }}

apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-dashboard-app-props

data:
  appProps.json: |
    {
      "authIssuerUrl": {{ include "dashboard.auth.hostname" $ | quote }},
      "authClientId": {{ default .Values.global.oidc.dashboardClientID "greenhouse" | quote }},
      "currentHost": {{ required ".Values.dashboard.assetServerURL missing" .Values.dashboard.assetServerURL | quote }},
      "apiEndpoint": {{ include "dashboard.api.hostname" $  | quote }},
      "demoUserToken": {{ get $secretData "token" | quote }}
    }

