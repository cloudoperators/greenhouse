# SPDX-FileCopyrightText: 2025 SAP SE or an SAP affiliate company and Greenhouse contributors
# SPDX-License-Identifier: Apache-2.0

nameOverride: ""
fullnameOverride: "greenhouse-authz"

replicaCount: 1

image:
  repository: ghcr.io/cloudoperators/greenhouse
  pullPolicy: IfNotPresent
  tag: v0.8.0

# This is for the secrets for pulling an image from a private repository more information can be found here: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
imagePullSecrets: []

serviceAccount:
  # Automatically mount a ServiceAccount's API credentials?
  automount: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set, a name is generated using the fullname template
  name: ""

# This is for setting Kubernetes Annotations to a Pod.
# For more information checkout: https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/
podAnnotations: {}
# This is for setting Kubernetes Labels to a Pod.
# For more information checkout: https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/
podLabels: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

livenessProbe:
  httpGet:
    path: /healthz
    port: 8081
readinessProbe:
  httpGet:
    path: /readyz
    port: 8081

authzService:
  type: ClusterIP
  ports:
    - name: webhook
      port: 9443
      targetPort: authz-server
      protocol: TCP

authzDeployment:
  volumes:
    - name: serving-certs
      hostPath:
        path: /etc/kubernetes/webhook/certs
        type: Directory
  volumeMounts:
    - name: serving-certs
      mountPath: /tmp/k8s-webhook-server/serving-certs
      readOnly: true
  containerPorts:
    - name: authz-server
      containerPort: 9443
      protocol: TCP