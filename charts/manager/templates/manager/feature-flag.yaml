apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "manager.fullname" . }}-feature-flags
data:
  _example: >
    ################################
    #                              #
    #    EXAMPLE CONFIGURATION     #
    #                              #
    ################################
    # enable dex features
    # storage allows you to choose what kind of dex storage backend you would like to choose
    # Greenhouse gives the choice of using kubernetes as the storage backend or to use postgresSQL as the backend
    dex: |
      storage: kubernetes / postgres
    # enable plugin features
    # optionValueTemplating allows you to enable or disable template rendering for plugin option values
    # set to false to disable template rendering (templates will be used as literal values)
    # set to true to enable template rendering (templates will be evaluated)
    # defaultDeploymentTool specifies the default deployment tool used for plugin deployments
    # set to "helm" for native Helm deployment (default)
    # set to "flux" for Flux-based deployment
    plugin: |
      optionValueTemplating: false / true
      defaultDeploymentTool: helm / flux
  dex: |
    storage: {{ include "dex.backend" $ }}
  plugin: |
    optionValueTemplating: {{ include "plugin.optionValueTemplating" $ }}
    {{- if .Values.global.plugin.defaultDeploymentTool }}
    defaultDeploymentTool: {{ .Values.global.plugin.defaultDeploymentTool }}
    {{- end }}
